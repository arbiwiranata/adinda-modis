a:2:{i:0;a:3:{s:10:"sourceFile";s:73:"D:\laragon\www\adinda-modis\plansys\components\ui\FormFields\GridView.php";s:4:"file";a:788:{i:0;s:5:"<?php";i:1;s:0:"";i:2;s:35:"use Box\Spout\Writer\WriterFactory;";i:3;s:26:"use Box\Spout\Common\Type;";i:4;s:34:"class GridView extends FormField {";i:5;s:0:"";i:6;s:45:"    public static $toolbarName  = "GridView";";i:7;s:50:"    public static $category     = "Data & Tables";";i:8;s:48:"    public static $toolbarIcon  = "fa fa-table";";i:9;s:41:"    public        $type         = 'Grid';";i:10;s:37:"    public        $name         = '';";i:11;s:43:"    public        $mode         = 'normal';";i:12;s:37:"    public        $label        = '';";i:13;s:45:"    public        $layout       = 'Vertical';";i:14;s:37:"    public        $vScroll       = 0;";i:15;s:37:"    public        $hScroll       = 0;";i:16;s:36:"    public        $labelWidth   = 4;";i:17;s:36:"    public        $fieldWidth   = 8;";i:18;s:37:"    public        $options      = [];";i:19;s:37:"    public        $tableOptions = [];";i:20;s:37:"    public        $datasource   = '';";i:21;s:37:"    public        $gridOptions  = [];";i:22;s:37:"    public        $genOptions   = [];";i:23;s:37:"    public        $columns      = [];";i:24;s:37:"    public        $columnsFunc  = "";";i:25;s:42:"    public        $columnsFuncParams = [];";i:26;s:40:"    public        $hasEditable  = false;";i:27;s:35:"    public        $freezeLock  = 0;";i:28;s:0:"";i:29;s:43:"    public function actionDownloadExcel() {";i:30;s:53:"        $postdata = file_get_contents("php://input");";i:31;s:45:"        $post     = CJSON::decode($postdata);";i:32;s:35:"        if (isset($post['rows'])) {";i:33;s:40:"            // header("Pragma: public");";i:34;s:36:"            // header("Expires: 0");";i:35;s:83:"            // header("Cache-Control: must-revalidate, post-check=0, pre-check=0");";i:36;s:66:"            // header("Content-Type: application/force-download");";i:37;s:64:"            // header("Content-Type: application/octet-stream");";i:38;s:61:"            // header("Content-Type: application/download");;";i:39;s:70:"            // header("Content-Disposition: attachment;filename=" . );";i:40;s:60:"            // header("Content-Transfer-Encoding: binary ");";i:41;s:56:"            $writer = WriterFactory::create(Type::XLSX);";i:42;s:68:"            $dir = Yii::getPathOfAlias('root.assets.gvExport') ."/";";i:43;s:32:"            if (!is_dir($dir)) {";i:44;s:40:"                mkdir($dir, 0755, true);";i:45;s:34:"                chmod($dir, 0755);";i:46;s:13:"            }";i:47;s:47:"            $file = "export-". time() .".xlsx";";i:48;s:85:"            $writer->openToFile($dir . $file); // stream data directly to the browser";i:49;s:75:"            $writer->addRows($post['rows']); // add multiple rows at a time";i:50;s:29:"            $writer->close();";i:51;s:67:"            echo Yii::app()->baseUrl . '/assets/gvExport/' . $file;";i:52;s:9:"        }";i:53;s:8:"        ";i:54;s:5:"    }";i:55;s:0:"";i:56;s:52:"    public function actionTemplate($n, $c, $k, $p) {";i:57;s:36:"        $fb = FormBuilder::load($c);";i:58;s:45:"        $ff = $fb->findField(['name' => $n]);";i:59;s:8:"        ";i:60;s:32:"        $this->attributes = $ff;";i:61;s:52:"        $this->prepareRender(json_decode($p, true));";i:62;s:47:"        include("GridView/template_table.php");";i:63;s:5:"    }";i:64;s:4:"    ";i:65;s:53:"    public function actionRetemplate($n, $c, $k, $p){";i:66;s:8:"        ";i:67;s:5:"    }";i:68;s:0:"";i:69;s:40:"    public function actionEditHeader() {";i:70;s:97:"        Asset::registerCSS(['application.components.ui.FormFields.GridView.grid-header-editor']);";i:71;s:69:"        Yii::app()->controller->renderForm('GridViewHeader',null,[],[";i:72;s:39:"            'layout'=>'//layouts/blank'";i:73;s:15:"        ]);    ";i:74;s:5:"    }";i:75;s:4:"    ";i:76;s:37:"    public function getErrorClass() {";i:77;s:74:"        return (count($this->errors) > 0 ? 'has-error has-feedback' : '');";i:78;s:5:"    }";i:79;s:0:"";i:80;s:34:"    public function includeCSS() {";i:81;s:52:"        return ['grid.css', 'date-time-picker.css'];";i:82;s:5:"    }";i:83;s:0:"";i:84;s:33:"    public function includeJS() {";i:85;s:30:"        return ['grid.v2.js'];";i:86;s:5:"    }";i:87;s:0:"";i:88;s:56:"    public function prepareRender($overideParams = []) {";i:89;s:32:"        $this->processColumns();";i:90;s:8:"        ";i:91;s:39:"        if ($this->columnsFunc != '') {";i:92;s:54:"            foreach ($this->columns as $idx => $col) {";i:93;s:76:"                $this->getHeaderTemplate($this->columns[$idx], $idx, 'tag');";i:94;s:13:"            }";i:95;s:12:"            ";i:96;s:25:"            $params = [];";i:97;s:58:"            foreach ($this->columnsFuncParams as $k=>$p) {";i:98;s:47:"                if (strpos($p, 'php:') === 0) {";i:99;s:65:"                    $params[$k] = $this->evaluateExpression($p, [";i:100;s:52:"                        'columns' => $this->columns,";i:101;s:81:"                        'data' => @$GLOBALS['dataSourceCache'][$this->datasource]";i:102;s:23:"                    ]);";i:103;s:17:"                }";i:104;s:13:"            }";i:105;s:12:"            ";i:106;s:48:"            foreach ($overideParams as $k=>$p) {";i:107;s:33:"                $params[$k] = $p;";i:108;s:13:"            }";i:109;s:12:"            ";i:110;s:76:"            $this->columns = $this->evaluateExpression($this->columnsFunc, [";i:111;s:44:"                'columns' => $this->columns,";i:112;s:36:"                'params' => $params,";i:113;s:73:"                'data' => @$GLOBALS['dataSourceCache'][$this->datasource]";i:114;s:15:"            ]);";i:115;s:9:"        }";i:116;s:8:"        ";i:117;s:44:"        foreach ($this->columns as $k=>$c) {";i:118;s:43:"            if (!isset($c['columnType'])) {";i:119;s:60:"                $this->columns[$k]['columnType'] = 'string';";i:120;s:13:"            }";i:121;s:9:"        }";i:122;s:5:"    }";i:123;s:0:"";i:124;s:30:"    public function render() {";i:125;s:31:"        $this->prepareRender();";i:126;s:60:"        return $this->renderInternal('template_render.php');";i:127;s:5:"    }";i:128;s:0:"";i:129;s:39:"    private function processColumns() {";i:130;s:46:"        foreach ($this->columns as $k => $c) {";i:131;s:64:"            $this->columns[$k] = $this->processSingleColumn($c);";i:132;s:9:"        }";i:133;s:5:"    }";i:134;s:0:"";i:135;s:46:"    private function processSingleColumn($c) {";i:136;s:41:"        $name = explode(".", $c['name']);";i:137;s:31:"        if (count($name) > 1) {";i:138;s:41:"            $c['fieldName'] = $c['name'];";i:139;s:47:"            $c['name']      = array_pop($name);";i:140;s:9:"        }";i:141;s:8:"        ";i:142;s:94:"        if (isset($c['options']['mode']) && strpos($c['options']['mode'], "editable") === 0) {";i:143;s:38:"            $this->hasEditable = true;";i:144;s:9:"        }";i:145;s:8:"        ";i:146;s:42:"        $c['options']['sortable'] = false;";i:147;s:0:"";i:148;s:18:"        return $c;";i:149;s:5:"    }";i:150;s:0:"";i:151;s:42:"    public function actionCellTemplate() {";i:152;s:53:"        $postdata = file_get_contents("php://input");";i:153;s:45:"        $post     = CJSON::decode($postdata);";i:154;s:54:"        $fb       = FormBuilder::load($post['class']);";i:155;s:62:"        $field    = $fb->findField(['name' => $post['name']]);";i:156;s:0:"";i:157;s:35:"        $this->attributes = $field;";i:158;s:70:"        $post['item']     = $this->processSingleColumn($post['item']);";i:159;s:64:"        echo $this->getRowTemplate($post['item'], $post['idx']);";i:160;s:5:"    }";i:161;s:0:"";i:162;s:68:"    public function getRowTemplate($col, $idx, $freezeLock = null) {";i:163;s:24:"        $template  = '';";i:164;s:24:"        $style     = '';";i:165;s:34:"        $fieldName = $col['name'];";i:166;s:15:"		$lock 		= '';";i:167;s:2:"		";i:168;s:69:"        if ($fieldName == "" && !@$col['options']['mode']) return "";";i:169;s:0:"";i:170;s:24:"        $attr      = [];";i:171;s:46:"        if (isset($col['options']['ng-if'])) {";i:172;s:54:"            $attr['ng-if'] = $col['options']['ng-if'];";i:173;s:9:"        }";i:174;s:2:"		";i:175;s:36:"		if($freezeLock == 1 && $idx == 0){";i:176;s:19:"			$lock = 'stick';";i:177;s:3:"		}";i:178;s:0:"";i:179;s:37:"        switch ($col['columnType']) {";i:180;s:26:"            case "string":";i:181;s:81:"                if (@$col['cellMode'] == 'custom' && trim(@$col['html']) != '') {";i:182;s:41:"                    return @$col['html'];";i:183;s:17:"                }";i:184;s:0:"";i:185;s:62:"                $template = '{{row[\'' . $fieldName . '\']}}';";i:186;s:22:"                break;";i:187;s:28:"            case "checkbox":";i:188;s:27:"                $ngif = "";";i:189;s:63:"                if (isset($col['options']['ng-checkbox-if'])) {";i:190;s:72:"                    $ngif = " && ({$col['options']['ng-checkbox-if']})";";i:191;s:17:"                }";i:192;s:16:"                ";i:193;s:29:"                $ngshow = "";";i:194;s:65:"                if (isset($col['options']['ng-checkbox-show'])) {";i:195;s:82:"                    $ngshow = "ng-show=\"{$col['options']['ng-checkbox-show']}\"";";i:196;s:17:"                }";i:197;s:16:"                ";i:198;s:58:"                if (isset($col['options']['ng-change'])) {";i:199;s:89:"                    $col['options']['ng-checkbox-change'] = $col['options']['ng-change'];";i:200;s:17:"                }";i:201;s:16:"                ";i:202;s:31:"                $ngchange = "";";i:203;s:67:"                if (isset($col['options']['ng-checkbox-change'])) {";i:204;s:75:"                    $ngchange = "{$col['options']['ng-checkbox-change']};";";i:205;s:17:"                }";i:206;s:16:"                ";i:207;s:33:"                $ngdisabled = "";";i:208;s:69:"                if (isset($col['options']['ng-checkbox-disabled'])) {";i:209;s:95:"                    $ngdisabled = "ng-disabled=\"{$col['options']['ng-checkbox-disabled']};\"";";i:210;s:17:"                }";i:211;s:16:"                ";i:212;s:134:"                $template = '<label class="cbl-'.$fieldName.'" ng-if="(row.$type == \'r\' || !row.$type) '.$ngif.'" '.$ngshow.'><input";i:213;s:87:"ng-click="checkboxRow(row, \'' . $fieldName . '\', ' . $idx . ', $event);'.$ngchange.'"";i:214;s:74:"ng-checked="checkboxRowChecked(row, \'' . $fieldName . '\', ' . $idx . ')"";i:215;s:15:"'.$ngdisabled.'";i:216;s:28:"type="checkbox" /></label>';";i:217;s:22:"                break;";i:218;s:9:"        }";i:219;s:0:"";i:220;s:23:"        $rowState = '';";i:221;s:24:"        if ($idx == 0) {";i:222;s:72:"            $rowStateCss = $this->hasEditable ? "class='editable'" : "";";i:223;s:118:"            if (@$this->gridOptions['showRowState'] != 'false' && @$this->gridOptions['showRowStateBtn'] != 'false') {";i:224;s:99:"                $rowState = "<div {$rowStateCss} ng-include='\"row-state-template\"'></div>\n    ";";i:225;s:13:"            }";i:226;s:80:"            if (!@$col['options']['mode'] && $col['columnType'] != 'checkbox') {";i:227;s:82:"                $template = "<span class='row-group-padding' ng-if='!!row.\$level'";i:228;s:51:"        style='width:{{row.\$level*10}}px;'></span>";i:229;s:17:"    {$template}";";i:230;s:13:"            }";i:231;s:9:"        }";i:232;s:0:"";i:233;s:0:"";i:234;s:23:"        $ngchange = '';";i:235;s:50:"        if (isset($col['options']['ng-change'])) {";i:236;s:77:"            $ngchange = ' ng-change="' . $col['options']['ng-change'] . '" ';";i:237;s:9:"        }";i:238;s:41:"        if (!!@$col['options']['mode']) {";i:239;s:30:"            $editableCss = '';";i:240;s:28:"            if ($idx == 0) {";i:241;s:79:"                $editableCss = 'style="padding-right: 0px;padding-left: 8px;"';";i:242;s:13:"            }";i:243;s:0:"";i:244;s:46:"            switch ($col['options']['mode']) {";i:245;s:28:"                case "html":";i:246;s:33:"                    $template = '";i:247;s:59:"    <div ng-bind-html="row[\'' . $fieldName . '\']></div>';";i:248;s:26:"                    break;";i:249;s:32:"                case "editable":";i:250;s:33:"                    $template = '";i:251;s:165:"    <div ceditable="true" ' . $editableCss . $ngchange . ' ng-paste="paste($event, row, $index, \''.$fieldName.'\', '.$idx.')" ng-model="row[\'' . $fieldName . '\']"";i:252;s:46:"         ng-keydown="editKey($event)"></div>';";i:253;s:22:"                break;";i:254;s:39:"                case "editable-insert":";i:255;s:33:"                    $template = '";i:256;s:94:"    <div ceditable="true" ' . $editableCss . $ngchange . ' ng-if="row.$rowState == \'insert\'"";i:257;s:82:"         ng-model="row[\'' . $fieldName . '\'] ng-keydown="editKey($event)"></div>";i:258;s:74:"    <span ng-show="row.$rowState != \'insert\'">' . $template . '</span>';";i:259;s:26:"                    break;";i:260;s:39:"                case "editable-update":";i:261;s:33:"                    $template = '";i:262;s:94:"    <div ceditable="true" ' . $editableCss . $ngchange . ' ng-if="row.$rowState != \'insert\'"";i:263;s:82:"         ng-model="row[\'' . $fieldName . '\'] ng-keydown="editKey($event)"></div>";i:264;s:74:"    <span ng-show="row.$rowState == \'insert\'">' . $template . '</span>';";i:265;s:26:"                    break;";i:266;s:34:"                case "del-button":";i:267;s:60:"                    if (!isset($col['options']['delUrl'])) {";i:268;s:59:"                        $style    = ' style="width:35px;"';";i:269;s:106:"                        $template = '<div ng-if="!row.$rowState" ng-click="removeRow(row)" title="Remove" ";i:270;s:67:"    class="btn btn-danger btn-xs"><i class="fa fa-trash"></i></div>";i:271;s:0:"";i:272;s:156:"    <div ng-if="(!row.$type || row.$type === \'r\') && [\'edit\',\'remove\'].indexOf(row.$rowState) >= 0" ng-click="undoRemoveRow(row)" title="Undo Remove" ";i:273;s:74:"         class="btn btn-default btn-xs"><i class="fa fa-undo"></i></div>';";i:274;s:28:"                    } else {";i:275;s:59:"                        $style    = ' style="width:35px;"';";i:276;s:126:"                        $template = '<a ng-if="(!row.$type || row.$type === \'r\')" ng-url="' . $col['options']['delUrl'] . '"";i:277;s:47:"    onClick="return confirm(\'Are you sure?\')"";i:278;s:77:"    class="btn-block btn btn-danger btn-xs"><i class="fa fa-trash"></i></a>';";i:279;s:21:"                    }";i:280;s:26:"                    break;";i:281;s:39:"                case "unchoose-button":";i:282;s:55:"                    $style    = ' style="width:35px;"';";i:283;s:158:"                    $template = '<div ng-if="(!row.$type || row.$type === \'r\') && (!row.$rowState || row.$rowState == \'insert\')" ng-click="removeRow(row)"";i:284;s:67:"    class="btn btn-danger btn-xs"><i class="fa fa-times"></i></div>";i:285;s:0:"";i:286;s:102:"    <div ng-if="[\'remove\'].indexOf(row.$rowState) >= 0" ng-click="undoRemoveRow(row)" title="Remove"";i:287;s:67:"    class="btn btn-default btn-xs"><i class="fa fa-undo"></i></div>";i:288;s:6:"    ';";i:289;s:26:"                    break;";i:290;s:41:"                case 'edit-popup-button':";i:291;s:55:"                    $style    = ' style="width:35px;"';";i:292;s:82:"                    $template = '<a ng-if="row.$rowState != \'insert\'" ng-click="";i:293;s:69:"'.$col['options']['popupName'].'.editId = row[datasource.primaryKey];";i:294;s:44:"' . $col['options']['popupName'] . '.open()"";i:295;s:76:"    class="btn-block btn btn-info btn-xs"><i class="fa fa-pencil"></i></a>';";i:296;s:26:"                    break;";i:297;s:35:"                case 'edit-button':";i:298;s:55:"                    $style    = ' style="width:35px;"';";i:299;s:139:"                    $template = '<a ng-if="(!row.$type || row.$type === \'r\')" ng-url="' . $col['options']['editUrl'] . '" title="Update" ";i:300;s:76:"    class="btn-block btn btn-info btn-xs"><i class="fa fa-pencil"></i></a>';";i:301;s:26:"                    break;";i:302;s:32:"                case 'sequence':";i:303;s:55:"                    $style    = ' style="width:35px;"';";i:304;s:70:"                    $template = '{{ getSequence(row, $index + 1); }}';";i:305;s:26:"                    break;";i:306;s:28:"                case 'date':";i:307;s:87:"                    $template = '{{row[\'' . $fieldName . '\'] | dateFormat:"date" }}';";i:308;s:26:"                    break;";i:309;s:28:"                case 'time':";i:310;s:87:"                    $template = '{{row[\'' . $fieldName . '\'] | dateFormat:"time" }}';";i:311;s:26:"                    break;";i:312;s:32:"                case 'datetime':";i:313;s:91:"                    $template = '{{row[\'' . $fieldName . '\'] | dateFormat:"datetime" }}';";i:314;s:26:"                    break;";i:315;s:34:"                case "datepicker":";i:316;s:48:"            $style    = ' style="width:150px;"';";i:317;s:37:"                        $template = '";i:318;s:48:"            <div class="date-field input-group">";i:319;s:26:"            <!-- value -->";i:320;s:307:"            <input type="text" class="form-control ng-pristine ng-untouched ng-valid ng-not-empty ng-valid-date" datepicker-popup="dd/MM/yyyy" datepicker-options="dateOptions" datepicker-mode="day" is-open="dateOpened" style="text-align:left !important;height:30px;color:#000;" ng-change=";changeDate(this)"";i:321;s:58:"                   ng-model="row[\'' . $fieldName . '\']" ";i:322;s:21:"                   />";i:323;s:0:"";i:324;s:33:"                <!-- btn icon -->";i:325;s:46:"                <span class="input-group-btn">";i:326;s:98:"                    <div ng-click="openDatePicker($event, $index)" class="btn btn-sm btn-default">";i:327;s:68:"                        <i class="glyphicon glyphicon-calendar"></i>";i:328;s:26:"                    </div>";i:329;s:23:"                </span>";i:330;s:14:"        </div>";i:331;s:26:"                        ';";i:332;s:26:"                    break;";i:333;s:13:"            }";i:334;s:9:"        }";i:335;s:8:"        ";i:336;s:39:"        $width = $this->getWidth($col);";i:337;s:27:"        if ($width != '') {";i:338;s:36:"            $attr['style'] = $width;";i:339;s:9:"        }";i:340;s:8:"        ";i:341;s:30:"        if (is_array($attr)) {";i:342;s:51:"            $attr = $this->expandAttributes($attr);";i:343;s:9:"        }";i:344;s:0:"";i:345;s:21:"        return <<<EOF";i:346;s:112:"<td{$style} class="col-{$idx} {$lock}" ng-class="rowClass(row, '{$fieldName}', '{$col['columnType']}')" {$attr}>";i:347;s:26:"    {$rowState}{$template}";i:348;s:5:"</td>";i:349;s:4:"EOF;";i:350;s:5:"    }";i:351;s:0:"";i:352;s:47:"    private function getStartingColumnGroup() {";i:353;s:46:"        foreach ($this->columns as $k => $c) {";i:354;s:56:"            if ($c['columnType'] == 'string') return $k;";i:355;s:9:"        }";i:356;s:5:"    }";i:357;s:0:"";i:358;s:50:"    public function getGroupTemplate($col, $idx) {";i:359;s:23:"        $template = '';";i:360;s:37:"        switch ($col['columnType']) {";i:361;s:26:"            case "string":";i:362;s:98:"                $template = '<td style="cursor:pointer;" ng-click="hideGroup(row, $event)"></td>';";i:363;s:22:"                break;";i:364;s:16:"            case";i:365;s:23:"            "checkbox":";i:366;s:34:"                $template = <<<EOF";i:367;s:90:"<td class="t-{$col['columnType']}"><label><input type="checkbox" class="cb-{$col['name']}"";i:368;s:84:"ng-click="checkboxGroup(\$index, '{$col['name']}', '$idx', \$event)" /></label></td>";i:369;s:4:"EOF;";i:370;s:22:"                break;";i:371;s:9:"        }";i:372;s:0:"";i:373;s:24:"        $attr      = [];";i:374;s:46:"        if (isset($col['options']['ng-if'])) {";i:375;s:54:"            $attr['ng-if'] = $col['options']['ng-if'];";i:376;s:9:"        }";i:377;s:46:"        $width = $this->getWidth($col, false);";i:378;s:27:"        if ($width != '') {";i:379;s:36:"            $attr['style'] = $width;";i:380;s:9:"        }";i:381;s:30:"        if (is_array($attr)) {";i:382;s:51:"            $attr = $this->expandAttributes($attr);";i:383;s:9:"        }";i:384;s:0:"";i:385;s:54:"        if ($idx == $this->getStartingColumnGroup()) {";i:386;s:25:"            $template = '";i:387;s:85:"<td class="t-' . $col['columnType'] . '" ng-click="hideGroup(row, $event)" '.$attr.'>";i:388;s:276:"    <div class="row-g" style="white-space:pre;cursor:pointer;"><span style="display:inline-block;width:{{row.$level*10}}px;float:"></span><i ng-if="!row.$hide" class="fa fa-caret-down"></i><i ng-if="!!row.$hide" class="fa fa-caret-right"></i>&nbsp; {{ row[row.$group] }}</div>";i:389;s:5:"</td>";i:390;s:2:"';";i:391;s:9:"        }";i:392;s:25:"        return $template;";i:393;s:5:"    }";i:394;s:0:"";i:395;s:59:"    public function generateHeaders($mode, $cols = false) {";i:396;s:105:"        $rowHeaders = isset($this->gridOptions['rowHeaders']) ? $this->gridOptions['rowHeaders'] * 1: 1; ";i:397;s:0:"";i:398;s:48:"        $cols = !$cols ? $this->columns : $cols;";i:399;s:22:"        $rowSpan = [];";i:400;s:8:"        ";i:401;s:19:"        ob_start();";i:402;s:45:"        for($i = $rowHeaders; $i >=1; $i--) {";i:403;s:66:"            echo ($mode== 'class' ? '<div class="tr">' : '<tr>'); ";i:404;s:45:"            foreach ($cols as $idx => $col) {";i:405;s:55:"                if (@$col['headers']['hide'] == true) {";i:406;s:29:"                    continue;";i:407;s:17:"                }";i:408;s:64:"                if (@$col['headers']['r' . $i]['rowSpan'] > 1) {";i:409;s:74:"                    $rowSpan[$idx] = ['current'=>$i,'total'=>$rowHeaders];";i:410;s:17:"                }";i:411;s:44:"                if (isset($rowSpan[$idx])) {";i:412;s:53:"                    $col['rowSpan'] = $rowSpan[$idx];";i:413;s:17:"                }";i:414;s:16:"                ";i:415;s:64:"                $cidx = isset($col['idx']) ? $col['idx'] : $idx;";i:416;s:30:"                if ($i == 1) {";i:417;s:64:"                    if (@$col['headers']['r1']['colSpan'] > 1) {";i:418;s:83:"                        echo $this->getSuperHeaderTemplate($i, $col, $cidx, $mode);";i:419;s:28:"                    } else {";i:420;s:74:"                        echo $this->getHeaderTemplate($col, $cidx, $mode);";i:421;s:21:"                    }";i:422;s:24:"                } else {";i:423;s:79:"                    echo $this->getSuperHeaderTemplate($i, $col, $cidx, $mode);";i:424;s:17:"                }";i:425;s:13:"            }";i:426;s:57:"            echo ($mode == 'class' ? '</div>' : '</tr>');";i:427;s:9:"        }";i:428;s:30:"        return ob_get_clean();";i:429;s:5:"    }";i:430;s:4:"    ";i:431;s:38:"    public function getFreezedCols() {";i:432;s:19:"        $cols = [];";i:433;s:48:"        foreach ($this->columns as $idx=>$col) {";i:434;s:55:"            if (@$col['options']['freeze'] == 'true') {";i:435;s:35:"                $col['idx'] = $idx;";i:436;s:31:"                $cols[] = $col;";i:437;s:13:"            }";i:438;s:9:"        }";i:439;s:21:"        return $cols;";i:440;s:5:"    }";i:441;s:4:"    ";i:442;s:55:"    private function getWidth($col, $overflow = true) {";i:443;s:46:"        if (@$col['options']['width'] != "") {";i:444;s:64:"            $style = 'width:' .$col['options']['width'] . 'px;';";i:445;s:69:"            $style .= 'min-width:' .$col['options']['width'] . 'px;';";i:446;s:69:"            $style .= 'max-width:' .$col['options']['width'] . 'px;';";i:447;s:28:"            if ($overflow) {";i:448;s:48:"                $style .= 'overflow-x: hidden;';";i:449;s:13:"            }";i:450;s:26:"            return $style;";i:451;s:9:"        }";i:452;s:8:"        ";i:453;s:18:"        return '';";i:454;s:5:"    }";i:455;s:4:"    ";i:456;s:69:"    public function getSuperHeaderTemplate($row, $col, $idx, $mode) {";i:457;s:24:"        $attr      = [];";i:458;s:29:"        $attr['cidx'] = $idx;";i:459;s:29:"        $attr['ridx'] = $row;";i:460;s:8:"        ";i:461;s:46:"        if (isset($col['options']['ng-if'])) {";i:462;s:54:"            $attr['ng-if'] = $col['options']['ng-if'];";i:463;s:9:"        }";i:464;s:8:"        ";i:465;s:52:"        if (@$col['options']['freeze'] === 'true') {";i:466;s:37:"            $attr['freeze'] = 'true';";i:467;s:9:"        }";i:468;s:8:"        ";i:469;s:38:"        if (!isset($col['headers'])) {";i:470;s:33:"            $col['headers'] = [];";i:471;s:9:"        }";i:472;s:8:"        ";i:473;s:49:"        if (!isset($col['headers']['r'. $row])) {";i:474;s:42:"            $col['headers']['r'. $row] = [";i:475;s:30:"                'label' => '',";i:476;s:32:"                'colSpan' => '1'";i:477;s:14:"            ];";i:478;s:9:"        }";i:479;s:8:"        ";i:480;s:46:"        $headers = $col['headers']['r'. $row];";i:481;s:39:"        $width = $this->getWidth($col);";i:482;s:8:"        ";i:483;s:27:"        if ($width != '') {";i:484;s:36:"            $attr['style'] = $width;";i:485;s:9:"        }";i:486;s:8:"        ";i:487;s:37:"        if (isset($col['rowSpan'])) {";i:488;s:53:"            if ($col['rowSpan']['current'] == $row) {";i:489;s:60:"                $attr['rowspan'] = $col['rowSpan']['total'];";i:490;s:20:"            } else {";i:491;s:26:"                return "";";i:492;s:13:"            }";i:493;s:9:"        }";i:494;s:8:"        ";i:495;s:38:"        if ($headers['colSpan'] < 1) {";i:496;s:22:"            return "";";i:497;s:45:"        } else if ($headers['colSpan'] > 1) {";i:498;s:52:"            $attr['colspan'] = $headers['colSpan']; ";i:499;s:9:"        }";i:500;s:30:"        if (is_array($attr)) {";i:501;s:51:"            $attr = $this->expandAttributes($attr);";i:502;s:9:"        }";i:503;s:8:"        ";i:504;s:23:"        if ($row > 1) {";i:505;s:41:"            $content = $headers['label'];";i:506;s:16:"        } else {";i:507;s:37:"            $content = $col['label'];";i:508;s:9:"        }";i:509;s:31:"        if ($mode == 'class') {";i:510;s:25:"            return <<<EOL";i:511;s:24:"<div class="th" {$attr}>";i:512;s:10:"{$content}";i:513;s:6:"</div>";i:514;s:4:"EOL;";i:515;s:16:"        } else {";i:516;s:25:"            return <<<EOL";i:517;s:31:"<th class="col-{$idx}" {$attr}>";i:518;s:10:"{$content}";i:519;s:5:"</th>";i:520;s:4:"EOL;";i:521;s:9:"        }";i:522;s:5:"    }";i:523;s:0:"";i:524;s:59:"    public function getHeaderTemplate(&$col, $idx, $mode) {";i:525;s:81:"        $fieldName = isset($col['fieldName']) ? $col['fieldName'] : $col['name'];";i:526;s:69:"        if ($fieldName == "" && !@$col['options']['mode']) return "";";i:527;s:0:"";i:528;s:24:"        $attr      = [];";i:529;s:29:"        $attr['cidx'] = $idx;";i:530;s:26:"        $attr['ridx'] = 1;";i:531;s:46:"        if (@$col['options']['ng-if'] != "") {";i:532;s:54:"            $attr['ng-if'] = $col['options']['ng-if'];";i:533;s:9:"        }";i:534;s:8:"        ";i:535;s:52:"        if (@$col['options']['freeze'] === 'true') {";i:536;s:37:"            $attr['freeze'] = 'true';";i:537;s:9:"        }";i:538;s:8:"        ";i:539;s:39:"        $width = $this->getWidth($col);";i:540;s:25:"        $st = '';        ";i:541;s:27:"        if ($width != '') {";i:542;s:26:"            $st .= $width;";i:543;s:9:"        }";i:544;s:0:"";i:545;s:70:"        if(isset($col['custom_style']) && $col['custom_style'] != ''){";i:546;s:40:"            $st .= $col['custom_style'];";i:547;s:9:"        }";i:548;s:8:"        ";i:549;s:22:"        if($st != ''){";i:550;s:33:"            $attr['style'] = $st;";i:551;s:9:"        }";i:552;s:37:"        if (isset($col['rowSpan'])) {";i:553;s:22:"            return "";";i:554;s:9:"        }";i:555;s:8:"        ";i:556;s:30:"        if (is_array($attr)) {";i:557;s:51:"            $attr = $this->expandAttributes($attr);";i:558;s:9:"        }";i:559;s:8:"        ";i:560;s:8:"        ";i:561;s:37:"        switch ($col['columnType']) {";i:562;s:26:"            case "string":";i:563;s:64:"                $sortable = "ng-click=\"sort('{$fieldName}')\"";";i:564;s:34:"                $caret    = <<<EOF";i:565;s:76:"        <i class="fa fa-caret-up" ng-if="isSort('{$fieldName}', 'asc')"></i>";i:566;s:79:"        <i class="fa fa-caret-down" ng-if="isSort('{$fieldName}', 'desc')"></i>";i:567;s:4:"EOF;";i:568;s:0:"";i:569;s:126:"                if (isset($col['options']) && isset($col['options']['sortable']) && $col['options']['sortable'] === 'false') {";i:570;s:35:"                    $sortable = '';";i:571;s:35:"                    $caret    = '';";i:572;s:17:"                }";i:573;s:0:"";i:574;s:34:"                 $content = <<<EOF";i:575;s:40:"    <div class="row-header" {$sortable}>";i:576;s:23:"        {$col['label']}";i:577;s:16:"        {$caret}";i:578;s:10:"    </div>";i:579;s:4:"EOF;";i:580;s:22:"                break;";i:581;s:28:"            case "checkbox":";i:582;s:27:"                $ngif = "";";i:583;s:68:"                if (isset($col['options']['ng-checkbox-head-if'])) {";i:584;s:83:"                    $ngif = "ng-if=\"({$col['options']['ng-checkbox-head-if']})\"";";i:585;s:17:"                }";i:586;s:16:"                ";i:587;s:34:"                $content =  <<<EOL";i:588;s:41:"    <label {$ngif}><input type="checkbox"";i:589;s:98:"ng-click="checkboxAll('{$col['name']}','{$idx}', \$event)" class="cb-th-{$col['name']}" /></label>";i:590;s:4:"EOL;";i:591;s:0:"";i:592;s:16:"                ";i:593;s:22:"                break;";i:594;s:9:"        }";i:595;s:8:"        ";i:596;s:39:"        if (isset($col['labelHtml'])) {";i:597;s:41:"            $content = $col['labelHtml'];";i:598;s:16:"        } else {";i:599;s:44:"            // $col['labelHtml'] = $content;";i:600;s:9:"        }";i:601;s:8:"        ";i:602;s:31:"        if ($mode == 'class') {";i:603;s:25:"            return <<<EOL";i:604;s:24:"<div class="th" {$attr}>";i:605;s:10:"{$content}";i:606;s:6:"</div>";i:607;s:4:"EOL;";i:608;s:16:"        } else {";i:609;s:25:"            return <<<EOL";i:610;s:31:"<th class="col-{$idx}" {$attr}>";i:611;s:10:"{$content}";i:612;s:5:"</th>";i:613;s:4:"EOL;";i:614;s:9:"        }";i:615;s:8:"        ";i:616;s:5:"    }";i:617;s:0:"";i:618;s:42:"    public function getFieldProperties() {";i:619;s:22:"        return array (";i:620;s:19:"            array (";i:621;s:43:"                'label' => 'GridView Name',";i:622;s:33:"                'name' => 'name',";i:623;s:36:"                'labelWidth' => '5',";i:624;s:36:"                'fieldWidth' => '7',";i:625;s:36:"                'options' => array (";i:626;s:48:"                    'ng-model' => 'active.name',";i:627;s:44:"                    'ng-change' => 'save()',";i:628;s:40:"                    'ng-delay' => '500',";i:629;s:18:"                ),";i:630;s:38:"                'type' => 'TextField',";i:631;s:14:"            ),";i:632;s:19:"            array (";i:633;s:46:"                'label' => 'Data Source Name',";i:634;s:39:"                'name' => 'datasource',";i:635;s:36:"                'options' => array (";i:636;s:54:"                    'ng-model' => 'active.datasource',";i:637;s:44:"                    'ng-change' => 'save()',";i:638;s:40:"                    'ng-delay' => '500',";i:639;s:50:"                    'ps-list' => 'dataSourceList',";i:640;s:18:"                ),";i:641;s:36:"                'labelWidth' => '5',";i:642;s:36:"                'fieldWidth' => '7',";i:643;s:41:"                'type' => 'DropDownList',";i:644;s:14:"            ),";i:645;s:19:"            array (";i:646;s:33:"                'type' => 'Text',";i:647;s:60:"                'value' => '<div class=\'clearfix\'></div>',";i:648;s:14:"            ),";i:649;s:19:"            array (";i:650;s:42:"                'label' => 'Grid Options',";i:651;s:40:"                'name' => 'gridOptions',";i:652;s:41:"                'type' => 'KeyValueGrid',";i:653;s:14:"            ),";i:654;s:19:"            array (";i:655;s:55:"                'label' => 'Container Element Options',";i:656;s:36:"                'name' => 'options',";i:657;s:41:"                'type' => 'KeyValueGrid',";i:658;s:14:"            ),";i:659;s:19:"            array (";i:660;s:51:"                'label' => 'Table Element Options',";i:661;s:41:"                'name' => 'tableOptions',";i:662;s:41:"                'type' => 'KeyValueGrid',";i:663;s:14:"            ),";i:664;s:19:"            array (";i:665;s:40:"                'label' => 'Max Height',";i:666;s:36:"                'name' => 'vScroll',";i:667;s:34:"                'postfix' => 'px',";i:668;s:36:"                'options' => array (";i:669;s:51:"                    'ng-model' => 'active.vScroll',";i:670;s:44:"                    'ng-change' => 'save()',";i:671;s:40:"                    'ng-delay' => '500',";i:672;s:18:"                ),";i:673;s:40:"                'type' => 'NumberField',";i:674;s:14:"            ),";i:675;s:19:"            array (";i:676;s:39:"                'label' => 'Max Width',";i:677;s:36:"                'name' => 'hScroll',";i:678;s:34:"                'postfix' => 'px',";i:679;s:36:"                'options' => array (";i:680;s:51:"                    'ng-model' => 'active.hScroll',";i:681;s:44:"                    'ng-change' => 'save()',";i:682;s:40:"                    'ng-delay' => '500',";i:683;s:18:"                ),";i:684;s:40:"                'type' => 'NumberField',";i:685;s:14:"            ),";i:686;s:19:"            array (";i:687;s:41:"                'label' => 'Freeze Lock',";i:688;s:39:"                'name' => 'freezeLock',";i:689;s:41:"                'defaultType' => 'first',";i:690;s:36:"                'options' => array (";i:691;s:54:"                    'ng-model' => 'active.freezeLock',";i:692;s:44:"                    'ng-change' => 'save()',";i:693;s:40:"                    'ng-delay' => '500',";i:694;s:18:"                ),";i:695;s:33:"                'list' => array (";i:696;s:32:"                    '0' => 'No',";i:697;s:33:"                    '1' => 'Yes',";i:698;s:18:"                ),";i:699;s:41:"                'type' => 'DropDownList',";i:700;s:14:"            ),";i:701;s:19:"            array (";i:702;s:46:"                'label' => 'Columns Function',";i:703;s:45:"                'fieldname' => 'columnsFunc',";i:704;s:79:"                'desc' => 'Use $columns and $data to get columns and data.<br/>";i:705;s:51:" e.g: YourClass::function($columns, $params, $data)";i:706;s:10:"<br/><br/>";i:707;s:59:"NOTE: to use $data, you must set \'cache\' = \'true\' <br/>";i:708;s:28:"in your DataSource Options',";i:709;s:44:"                'type' => 'ExpressionField',";i:710;s:14:"            ),";i:711;s:19:"            array (";i:712;s:53:"                'label' => 'Columns Function Params',";i:713;s:46:"                'name' => 'columnsFuncParams',";i:714;s:36:"                'options' => array (";i:715;s:54:"                    'ng-if' => '!!active.columnsFunc',";i:716;s:18:"                ),";i:717;s:41:"                'type' => 'KeyValueGrid',";i:718;s:14:"            ),";i:719;s:19:"            array (";i:720;s:36:"                'title' => 'Header',";i:721;s:42:"                'type' => 'SectionHeader',";i:722;s:14:"            ),";i:723;s:19:"            array (";i:724;s:33:"                'type' => 'Text',";i:725;s:65:"                'value' => '<div ng-click=\"headerPopUp.open()\" ";i:726;s:31:"     style=\'margin-top:-25px\'";i:727;s:46:"     class=\"btn btn-xs pull-right btn-info\">";i:728;s:53:"    <b><i class=\"fa fa-pencil\"></i> Edit Header</b>";i:729;s:8:"</div>',";i:730;s:14:"            ),";i:731;s:19:"            array (";i:732;s:40:"                'type' => 'PopupWindow',";i:733;s:40:"                'name' => 'headerPopUp',";i:734;s:36:"                'options' => array (";i:735;s:37:"                    'width' => '800',";i:736;s:38:"                    'height' => '400',";i:737;s:18:"                ),";i:738;s:32:"                'mode' => 'url',";i:739;s:83:"                'subForm' => 'application.components.ui.FormFields.GridViewHeader',";i:740;s:58:"                'url' => '/formfield/GridView.editHeader',";i:741;s:53:"                'title' => 'GridView Header Setting',";i:742;s:80:"                'parentForm' => 'application.components.ui.FormFields.GridView',";i:743;s:14:"            ),";i:744;s:19:"            array (";i:745;s:37:"                'title' => 'Columns',";i:746;s:42:"                'type' => 'SectionHeader',";i:747;s:14:"            ),";i:748;s:19:"            array (";i:749;s:46:"                'label' => 'Generate Columns',";i:750;s:42:"                'buttonType' => 'success',";i:751;s:34:"                'icon' => 'magic',";i:752;s:41:"                'buttonSize' => 'btn-xs',";i:753;s:36:"                'options' => array (";i:754;s:71:"                    'style' => 'float:right;margin:-25px 0px 0px 0px;',";i:755;s:61:"                    'ng-show' => 'active.datasource != \'\'',";i:756;s:54:"                    'ng-click' => 'generateColumns()',";i:757;s:18:"                ),";i:758;s:39:"                'type' => 'LinkButton',";i:759;s:14:"            ),";i:760;s:19:"            array (";i:761;s:33:"                'type' => 'Text',";i:762;s:66:"                'value' => '<div style=\'margin-top:5px\'></div>',";i:763;s:14:"            ),";i:764;s:19:"            array (";i:765;s:36:"                'name' => 'columns',";i:766;s:42:"                'fieldTemplate' => 'form',";i:767;s:85:"                'templateForm' => 'application.components.ui.FormFields.GridViewCol',";i:768;s:57:"                'inlineJS' => 'GridView/grid-builder.js',";i:769;s:36:"                'options' => array (";i:770;s:51:"                    'ng-model' => 'active.columns',";i:771;s:44:"                    'ng-change' => 'save()',";i:772;s:18:"                ),";i:773;s:45:"                'singleViewOption' => array (";i:774;s:36:"                    'name' => 'val',";i:775;s:42:"                    'fieldType' => 'text',";i:776;s:38:"                    'labelWidth' => 0,";i:777;s:39:"                    'fieldWidth' => 12,";i:778;s:45:"                    'fieldOptions' => array (";i:779;s:42:"                        'ng-delay' => 500,";i:780;s:22:"                    ),";i:781;s:18:"                ),";i:782;s:37:"                'type' => 'ListView',";i:783;s:14:"            ),";i:784;s:10:"        );";i:785;s:5:"    }";i:786;s:0:"";i:787;s:1:"}";}s:7:"methods";a:21:{s:19:"actionDownloadExcel";a:2:{s:4:"line";i:29;s:6:"length";i:26;}s:14:"actionTemplate";a:2:{s:4:"line";i:56;s:6:"length";i:8;}s:16:"actionRetemplate";a:2:{s:4:"line";i:65;s:6:"length";i:3;}s:16:"actionEditHeader";a:2:{s:4:"line";i:69;s:6:"length";i:6;}s:13:"getErrorClass";a:2:{s:4:"line";i:76;s:6:"length";i:3;}s:10:"includeCSS";a:2:{s:4:"line";i:80;s:6:"length";i:3;}s:9:"includeJS";a:2:{s:4:"line";i:84;s:6:"length";i:3;}s:13:"prepareRender";a:2:{s:4:"line";i:88;s:6:"length";i:35;}s:6:"render";a:2:{s:4:"line";i:124;s:6:"length";i:4;}s:14:"processColumns";a:2:{s:4:"line";i:129;s:6:"length";i:5;}s:19:"processSingleColumn";a:2:{s:4:"line";i:135;s:6:"length";i:15;}s:18:"actionCellTemplate";a:2:{s:4:"line";i:151;s:6:"length";i:10;}s:14:"getRowTemplate";a:2:{s:4:"line";i:162;s:6:"length";i:189;}s:22:"getStartingColumnGroup";a:2:{s:4:"line";i:352;s:6:"length";i:5;}s:16:"getGroupTemplate";a:2:{s:4:"line";i:358;s:6:"length";i:36;}s:15:"generateHeaders";a:2:{s:4:"line";i:395;s:6:"length";i:35;}s:14:"getFreezedCols";a:2:{s:4:"line";i:431;s:6:"length";i:10;}s:8:"getWidth";a:2:{s:4:"line";i:442;s:6:"length";i:13;}s:22:"getSuperHeaderTemplate";a:2:{s:4:"line";i:456;s:6:"length";i:67;}s:17:"getHeaderTemplate";a:2:{s:4:"line";i:524;s:6:"length";i:93;}s:18:"getFieldProperties";a:2:{s:4:"line";i:618;s:6:"length";i:168;}}}i:1;N;}